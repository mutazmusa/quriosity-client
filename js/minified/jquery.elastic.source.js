(function(a){a.fn.extend({elastic:function(){var c=true;var b=["paddingTop","paddingRight","paddingBottom","paddingLeft","fontSize","lineHeight","fontFamily","width","fontWeight"];return this.each(function(){if(this.type!="textarea"){return false}var h=a(this),d=a("<div />").css({position:"absolute",display:"none","word-wrap":"break-word"}),j=parseInt(h.css("line-height"),10),l=parseInt(20),k=parseInt(h.css("max-height"),10)||Number.MAX_VALUE,e=0,g=0;if(k<0){k=Number.MAX_VALUE}d.appendTo(h.parent());var g=b.length;while(g--){d.css(b[g].toString(),h.css(b[g].toString()))}function m(i,n){curratedHeight=Math.floor(parseInt(i,10));if(h.height()!=curratedHeight){h.css({height:curratedHeight+"px",overflow:n})}}function f(){var o=h.val().replace(/&/g,"&amp;").replace(/  /g,"&nbsp;").replace(/<|>/g,"&gt;").replace(/\n/g,"<br />");var i=d.html().replace(/<br>/ig,"<br />");if(o+"&nbsp;"!=i){d.html(o+"&nbsp;");if(Math.abs(d.height()+j-h.height())>3){var n=d.height()+j-10;if(n>=k){m(k,"auto")}else{if(n<=l){m(l,"hidden")}else{m(n,"hidden")}}}}}h.css({overflow:"hidden"});h.bind("keyup change cut paste",function(){f()});h.live("input paste",function(i){setTimeout(f,250)});f();c=true})}})})(jQuery);